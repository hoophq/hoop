package mssqltypes

// import (
// 	"encoding/hex"
// 	"testing"
// )

// func TestRpcRequestDecode(t *testing.T) {
// 	for _, tt := range []struct {
// 		msg       string
// 		want      string
// 		pktStream string
// 	}{
// 		{
// 			msg:       "it should decode a rpc request procedure sp_ExecuteSql",
// 			want:      `SELECT TOP 0 1 AS "_" FROM "dbo"."ErrorLog" WHERE 1 <> 1`,
// 			pktStream: "030100a20035010016000000120000000200000000000000000001000000ffff0a0000000000e7401f0904d000347200530045004c00450043005400200054004f0050002000300020003100200041005300200022005f0022002000460052004f004d0020002200640062006f0022002e0022004500720072006f0072004c006f00670022002000570048004500520045002000310020003c003e00200031002000",
// 		},
// 		{
// 			msg:       "it should decode a rpc request procedure sp_ExecuteSql with multiple parameters",
// 			want:      "DECLARE @mssqljdbc_temp_sp_columns_result TABLE(TABLE_QUALIFIER SYSNAME, TABLE_OWNER SYSNAME,TABLE_NAME SYSNAME, COLUMN_NAME SYSNAME, DATA_TYPE SMALLINT, TYPE_NAME SYSNAME, PRECISION INT,LENGTH INT, SCALE SMALLINT, RADIX SMALLINT, NULLABLE SMALLINT, REMARKS VARCHAR(254), COLUMN_DEF NVARCHAR(4000),SQL_DATA_TYPE SMALLINT, SQL_DATETIME_SUB SMALLINT, CHAR_OCTET_LENGTH INT, ORDINAL_POSITION INT,IS_NULLABLE VARCHAR(254), SS_IS_SPARSE SMALLINT, SS_IS_COLUMN_SET SMALLINT, SS_IS_COMPUTED SMALLINT,SS_IS_IDENTITY SMALLINT, SS_UDT_CATALOG_NAME NVARCHAR(128), SS_UDT_SCHEMA_NAME NVARCHAR(128),SS_UDT_ASSEMBLY_TYPE_NAME NVARCHAR(max), SS_XML_SCHEMACOLLECTION_CATALOG_NAME NVARCHAR(128),SS_XML_SCHEMACOLLECTION_SCHEMA_NAME NVARCHAR(128), SS_XML_SCHEMACOLLECTION_NAME NVARCHAR(128),SS_DATA_TYPE TINYINT);INSERT INTO @mssqljdbc_temp_sp_columns_result EXEC sp_columns_100 @P0,@P1,@P2,@P3,@P4,@P5;SELECT TABLE_QUALIFIER AS TABLE_CAT, TABLE_OWNER AS TABLE_SCHEM, TABLE_NAME, COLUMN_NAME, DATA_TYPE,TYPE_NAME, PRECISION AS COLUMN_SIZE, LENGTH AS BUFFER_LENGTH, SCALE AS DECIMAL_DIGITS, RADIX AS NUM_PREC_RADIX,NULLABLE, REMARKS, COLUMN_DEF, SQL_DATA_TYPE, SQL_DATETIME_SUB, CHAR_OCTET_LENGTH, ORDINAL_POSITION, IS_NULLABLE,NULL AS SCOPE_CATALOG, NULL AS SCOPE_SCHEMA, NULL AS SCOPE_TABLE, SS_DATA_TYPE AS SOURCE_DATA_TYPE,CASE SS_IS_IDENTITY WHEN 0 THEN 'NO' WHEN 1 THEN 'YES' WHEN '' THEN '' END AS IS_AUTOINCREMENT,CASE SS_IS_COMPUTED WHEN 0 THEN 'NO' WHEN 1 THEN 'YES' WHEN '' THEN '' END AS IS_GENERATEDCOLUMN, SS_IS_SPARSE, SS_IS_COLUMN_SET, SS_UDT_CATALOG_NAME, SS_UDT_SCHEMA_NAME, SS_UDT_ASSEMBLY_TYPE_NAME,SS_XML_SCHEMACOLLECTION_CATALOG_NAME, SS_XML_SCHEMACOLLECTION_SCHEMA_NAME, SS_XML_SCHEMACOLLECTION_NAME FROM @mssqljdbc_temp_sp_columns_result ORDER BY TABLE_CAT, TABLE_SCHEM, TABLE_NAME, ORDINAL_POSITION",
// 			pktStream: "03010f900035010016000000120000000200000000000000000001000000ffff0a0000000000e7401f0904d00034180e4400450043004c00410052004500200040006d007300730071006c006a006400620063005f00740065006d0070005f00730070005f0063006f006c0075006d006e0073005f0072006500730075006c00740020005400410042004c00450028005400410042004c0045005f005100550041004c004900460049004500520020005300590053004e0041004d0045002c0020005400410042004c0045005f004f0057004e004500520020005300590053004e0041004d0045002c005400410042004c0045005f004e0041004d00450020005300590053004e0041004d0045002c00200043004f004c0055004d004e005f004e0041004d00450020005300590053004e0041004d0045002c00200044004100540041005f005400590050004500200053004d0041004c004c0049004e0054002c00200054005900500045005f004e0041004d00450020005300590053004e0041004d0045002c00200050005200450043004900530049004f004e00200049004e0054002c004c0045004e00470054004800200049004e0054002c0020005300430041004c004500200053004d0041004c004c0049004e0054002c00200052004100440049005800200053004d0041004c004c0049004e0054002c0020004e0055004c004c00410042004c004500200053004d0041004c004c0049004e0054002c002000520045004d00410052004b00530020005600410052004300480041005200280032003500340029002c00200043004f004c0055004d004e005f0044004500460020004e0056004100520043004800410052002800340030003000300029002c00530051004c005f0044004100540041005f005400590050004500200053004d0041004c004c0049004e0054002c002000530051004c005f004400410054004500540049004d0045005f00530055004200200053004d0041004c004c0049004e0054002c00200043004800410052005f004f0043005400450054005f004c0045004e00470054004800200049004e0054002c0020004f005200440049004e0041004c005f0050004f0053004900540049004f004e00200049004e0054002c00490053005f004e0055004c004c00410042004c00450020005600410052004300480041005200280032003500340029002c002000530053005f00490053005f00530050004100520053004500200053004d0041004c004c0049004e0054002c002000530053005f00490053005f0043004f004c0055004d004e005f00530045005400200053004d0041004c004c0049004e0054002c002000530053005f00490053005f0043004f004d0050005500540045004400200053004d0041004c004c0049004e0054002c00530053005f00490053005f004900440045004e005400490054005900200053004d0041004c004c0049004e0054002c002000530053005f005500440054005f0043004100540041004c004f0047005f004e0041004d00450020004e005600410052004300480041005200280031003200380029002c002000530053005f005500440054005f0053004300480045004d0041005f004e0041004d00450020004e005600410052004300480041005200280031003200380029002c00530053005f005500440054005f0041005300530045004d0042004c0059005f0054005900500045005f004e0041004d00450020004e00560041005200430048004100520028006d006100780029002c002000530053005f0058004d004c005f0053004300480045004d00410043004f004c004c0045004300540049004f004e005f0043004100540041004c004f0047005f004e0041004d00450020004e005600410052004300480041005200280031003200380029002c00530053005f0058004d004c005f0053004300480045004d00410043004f004c004c0045004300540049004f004e005f0053004300480045004d0041005f004e0041004d00450020004e005600410052004300480041005200280031003200380029002c002000530053005f0058004d004c005f0053004300480045004d00410043004f004c004c0045004300540049004f004e005f004e0041004d00450020004e005600410052004300480041005200280031003200380029002c00530053005f0044004100540041005f0054005900500045002000540049004e00590049004e00540029003b0049004e005300450052005400200049004e0054004f00200040006d007300730071006c006a006400620063005f00740065006d0070005f00730070005f0063006f006c0075006d006e0073005f0072006500730075006c007400200045005800450043002000730070005f0063006f006c0075006d006e0073005f0031003000300020004000500030002c004000500031002c004000500032002c004000500033002c004000500034002c004000500035003b00530045004c0045004300540020005400410042004c0045005f005100550041004c004900460049004500520020004100530020005400410042004c0045005f004300410054002c0020005400410042004c0045005f004f0057004e004500520020004100530020005400410042004c0045005f0053004300480045004d002c0020005400410042004c0045005f004e0041004d0045002c00200043004f004c0055004d004e005f004e0041004d0045002c00200044004100540041005f0054005900500045002c0054005900500045005f004e0041004d0045002c00200050005200450043004900530049004f004e00200041005300200043004f004c0055004d004e005f00530049005a0045002c0020004c0045004e0047005400480020004100530020004200550046004600450052005f004c0045004e004700540048002c0020005300430041004c004500200041005300200044004500430049004d0041004c005f004400490047004900540053002c0020005200410044004900580020004100530020004e0055004d005f0050005200450043005f00520041004400490058002c004e0055004c004c00410042004c0045002c002000520045004d00410052004b0053002c00200043004f004c0055004d004e005f004400450046002c002000530051004c005f0044004100540041005f0054005900500045002c002000530051004c005f004400410054004500540049004d0045005f005300550042002c00200043004800410052005f004f0043005400450054005f004c0045004e004700540048002c0020004f005200440049004e0041004c005f0050004f0053004900540049004f004e002c002000490053005f004e0055004c004c00410042004c0045002c004e0055004c004c002000410053002000530043004f00500045005f0043004100540041004c004f0047002c0020004e0055004c004c002000410053002000530043004f00500045005f0053004300480045004d0041002c0020004e0055004c004c002000410053002000530043004f00500045005f005400410042004c0045002c002000530053005f0044004100540041005f005400590050004500200041005300200053004f0055005200430045005f0044004100540041005f0054005900500045002c0043004100530045002000530053005f00490053005f004900440045004e00540049005400590020005700480045004e002000300020005400480045004e00200027004e004f00270020005700480045004e002000310020005400480045004e0020002700590045005300270020005700480045004e0020002700270020005400480045004e00200027002700200045004e0044002000410053002000490053005f004100550054004f0049004e004300520045004d0045004e0054002c0043004100530045002000530053005f00490053005f0043004f004d005000550054004500440020005700480045004e002000300020005400480045004e00200027004e004f00270020005700480045004e002000310020005400480045004e0020002700590045005300270020005700480045004e0020002700270020005400480045004e00200027002700200045004e0044002000410053002000490053005f00470045004e0045005200410054004500440043004f004c0055004d004e002c002000530053005f00490053005f005300500041005200530045002c002000530053005f00490053005f0043004f004c0055004d004e005f005300450054002c002000530053005f005500440054005f0043004100540041004c004f0047005f004e0041004d0045002c002000530053005f005500440054005f0053004300480045004d0041005f004e0041004d0045002c002000530053005f005500440054005f0041005300530045004d0042004c0059005f0054005900500045005f004e0041004d0045002c00530053005f0058004d004c005f0053004300480045004d00410043004f004c004c0045004300540049004f004e005f0043004100540041004c004f0047005f004e0041004d0045002c002000530053005f0058004d004c005f0053004300480045004d00410043004f004c004c0045004300540049004f004e005f0053004300480045004d0041005f004e0041004d0045002c002000530053005f0058004d004c005f0053004300480045004d00410043004f004c004c0045004300540049004f004e005f004e0041004d0045002000460052004f004d00200040006d007300730071006c006a006400620063005f00740065006d0070005f00730070005f0063006f006c0075006d006e0073005f0072006500730075006c00740020004f00520044004500520020004200590020005400410042004c0045005f004300410054002c0020005400410042004c0045005f0053004300480045004d002c0020005400410042004c0045005f004e0041004d0045002c0020004f005200440049004e0041004c005f0050004f0053004900540049004f004e003b000000e7401f0904d00034b60040005000300020006e0076006100720063006800610072002800340030003000300029002c0040005000310020006e0076006100720063006800610072002800340030003000300029002c0040005000320020006e0076006100720063006800610072002800340030003000300029002c0040005000330020006e0076006100720063006800610072002800340030003000300029002c00400050003400200069006e0074002c00400050003500200069006e0074000000e7401f0904d000341800500072006f0064007500630074004d006f00640065006c000000e7401f0904d000340e00530061006c00650073004c0054000000e7401f0904d000341c0061006400760065006e00740075007200650077006f0072006b0073000000e7401f0904d0003402002500000026040402000000000026040403000000",
// 		},
// 		{
// 			msg:       "it should not decode non sp_ExecuteSql procedure",
// 			want:      "",
// 			pktStream: "0301008d0035010016000000120000000200000000000000000001000000ffff0c0000000000260404020000000000e7401f0904d000343c00500072006f0064007500630074004d006f00640065006c00500072006f0064007500630074004400650073006300720069007000740069006f006e000000e7401f0904d00034ffff0000e7401f0904d00034ffff",
// 		},
// 	} {
// 		t.Run(tt.msg, func(t *testing.T) {
// 			data, _ := hex.DecodeString(tt.pktStream)
// 			got, err := DecodeRpcRequestToRawQuery(data)
// 			if err != nil {
// 				t.Fatalf("do not expect error when decoding rpc request packet, err=%v", err)
// 			}
// 			if tt.want != got {
// 				t.Errorf("expect to decode rpc request, want=%q, got=%q", tt.want, got)
// 			}
// 		})
// 	}
// }
